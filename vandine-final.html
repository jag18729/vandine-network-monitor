<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vandine Zero-Trust Network Operations Center</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, system-ui, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            color: #e4e4e7;
            min-height: 100vh;
        }
        .header {
            background: rgba(21, 25, 50, 0.95);
            padding: 1rem 2rem;
            border-bottom: 2px solid #00d4ff;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .security-badge {
            background: linear-gradient(135deg, #10b981, #059669);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        .nav-links {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .nav-links a {
            color: #a1a1aa;
            text-decoration: none;
            padding: 0.4rem 0.8rem;
            border-radius: 5px;
            transition: all 0.3s;
            font-size: 0.85rem;
            border: 1px solid transparent;
        }
        .nav-links a:hover {
            background: rgba(0, 212, 255, 0.1);
            color: #00d4ff;
            border-color: #00d4ff;
        }
        .container { max-width: 1800px; margin: 0 auto; padding: 2rem; }
        h1 { text-align: center; color: #00d4ff; font-size: 2.5rem; margin-bottom: 0.5rem; }
        .subtitle { text-align: center; color: #a1a1aa; margin-bottom: 1rem; }

        .main-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: rgba(21, 25, 50, 0.5);
            padding: 0.5rem;
            border-radius: 10px;
            overflow-x: auto;
            flex-wrap: wrap;
        }
        .main-tab {
            padding: 0.8rem 1.2rem;
            background: transparent;
            border: 2px solid transparent;
            color: #a1a1aa;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 5px;
            font-size: 0.95rem;
            white-space: nowrap;
            text-decoration: none;
        }
        .main-tab:hover {
            background: rgba(0, 212, 255, 0.1);
        }
        .main-tab.active {
            background: linear-gradient(135deg, #00d4ff, #00a3cc);
            color: white;
            border-color: #00d4ff;
        }
        .page { display: none; }
        .page.active { display: block; }

        /* Quick Links */
        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        .quick-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
            background: rgba(21, 25, 50, 0.9);
            border: 1px solid #2a2e4a;
            border-radius: 8px;
            text-decoration: none;
            color: #e4e4e7;
            transition: all 0.3s;
            text-align: center;
        }
        .quick-link:hover {
            border-color: #00d4ff;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 212, 255, 0.2);
        }
        .quick-link-icon { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .quick-link-title { font-size: 0.85rem; color: #00ff88; font-weight: 600; }

        .infrastructure-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .device-card {
            background: rgba(21, 25, 50, 0.9);
            border: 2px solid #2a2e4a;
            border-radius: 10px;
            padding: 1.5rem;
            position: relative;
            transition: all 0.3s;
        }
        .device-card:hover {
            border-color: #00d4ff;
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2);
        }
        .device-card.online { border-left: 4px solid #10b981; }
        .device-card.offline { border-left: 4px solid #ef4444; }
        .device-card.warning { border-left: 4px solid #f59e0b; }

        .device-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .device-name {
            font-size: 1.2rem;
            color: #00ff88;
            font-weight: bold;
        }
        .device-status {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        .status-online { background: rgba(16, 185, 129, 0.2); color: #10b981; }
        .status-offline { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .status-warning { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }

        .device-info {
            display: grid;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
        }
        .info-label { color: #a1a1aa; }
        .info-value { color: #e4e4e7; font-family: 'JetBrains Mono', monospace; }

        .device-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        .device-actions button, .action-btn {
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #00d4ff, #00a3cc);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
            text-decoration: none;
        }
        .device-actions button:hover, .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.3);
        }
        button.secondary, .secondary {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
        }
        button.secondary:hover, .secondary:hover {
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }

        .test-section {
            background: rgba(21, 25, 50, 0.8);
            border: 1px solid #2a2e4a;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .automation-panel {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(0, 212, 255, 0.1));
            border: 2px solid #10b981;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .zero-trust-indicator {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 1rem;
        }
        .trust-level {
            font-size: 2rem;
            font-weight: bold;
        }
        .trust-high { color: #10b981; }
        .trust-medium { color: #f59e0b; }
        .trust-low { color: #ef4444; }

        .cloudflare-panel {
            background: linear-gradient(135deg, rgba(244, 129, 32, 0.1), rgba(0, 81, 195, 0.1));
            border: 2px solid #f48120;
        }

        .palo-alto-panel {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.1), rgba(239, 68, 68, 0.1));
            border: 2px solid #dc2626;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .metric {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 10px;
            text-align: center;
        }
        .metric-value {
            font-size: 2rem;
            color: #00d4ff;
            font-weight: bold;
            font-family: 'JetBrains Mono', monospace;
        }
        .metric-label {
            color: #a1a1aa;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        .result-box {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #2a2e4a;
            border-radius: 5px;
            font-family: 'JetBrains Mono', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            color: #00ff88;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        h3 {
            color: #00ff88;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .speed-test-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #f48120, #0051c3);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }
        .speed-test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(244, 129, 32, 0.4);
        }

        .edge-detect-btn {
            background: linear-gradient(135deg, #f48120, #ff6b00);
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        .edge-detect-btn:hover {
            transform: translateY(-2px);
        }

        .healing-status {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(21, 25, 50, 0.95);
            border: 2px solid #10b981;
            border-radius: 10px;
            padding: 1rem;
            min-width: 250px;
            z-index: 50;
        }
        .healing-active {
            color: #10b981;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .footer {
            background: rgba(21, 25, 50, 0.95);
            border-top: 1px solid #2a2e4a;
            padding: 1.5rem;
            margin-top: 2rem;
            text-align: center;
        }
        .footer a {
            color: #a1a1aa;
            text-decoration: none;
            margin: 0 1rem;
            transition: color 0.3s;
        }
        .footer a:hover { color: #00d4ff; }

        @media (max-width: 768px) {
            .header-top { flex-direction: column; gap: 1rem; }
            .nav-links { justify-content: center; }
            .healing-status { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-top">
            <div class="security-badge">Zero Trust Active</div>
            <div class="nav-links">
                <a href="nasa.html">NASA Principles</a>
                <a href="dns-dashboard.html">DNS Dashboard</a>
                <a href="network-test.html">Network Lab</a>
                <a href="devops.html">DevOps</a>
                <a href="agent-dashboard.html">Agent</a>
                <a href="https://github.com/jag18729" target="_blank">GitHub</a>
            </div>
        </div>
        <h1>Vandine Zero-Trust Network Operations Center</h1>
        <p class="subtitle">Enterprise Infrastructure | Agentic Edge Computing | Self-Healing Architecture</p>

        <div class="main-tabs">
            <button class="main-tab active" onclick="switchPage(event, 'infrastructure')">Infrastructure</button>
            <button class="main-tab" onclick="switchPage(event, 'paloalto')">Palo Alto PA-220</button>
            <button class="main-tab" onclick="switchPage(event, 'cloudflare')">Cloudflare Edge</button>
            <button class="main-tab" onclick="switchPage(event, 'routetest')">Route Testing</button>
            <button class="main-tab" onclick="switchPage(event, 'udm')">UniFi Dream Machine</button>
            <button class="main-tab" onclick="switchPage(event, 'raspberrypi')">Raspberry Pi Cluster</button>
            <button class="main-tab" onclick="switchPage(event, 'zerotrust')">Zero Trust</button>
            <button class="main-tab" onclick="switchPage(event, 'automation')">Automation</button>
            <button class="main-tab" onclick="switchPage(event, 'selfhealing')">Self-Healing</button>
        </div>
    </div>

    <div class="container">
        <!-- Quick Links Bar -->
        <div class="quick-links">
            <a href="nasa.html" class="quick-link">
                <span class="quick-link-icon">üöÄ</span>
                <span class="quick-link-title">NASA Principles</span>
            </a>
            <a href="dns-dashboard.html" class="quick-link">
                <span class="quick-link-icon">üåê</span>
                <span class="quick-link-title">DNS Dashboard</span>
            </a>
            <a href="network-test.html" class="quick-link">
                <span class="quick-link-icon">üî¨</span>
                <span class="quick-link-title">Network Lab</span>
            </a>
            <a href="devops.html" class="quick-link">
                <span class="quick-link-icon">‚öôÔ∏è</span>
                <span class="quick-link-title">DevOps Center</span>
            </a>
            <a href="agent-dashboard.html" class="quick-link">
                <span class="quick-link-icon">ü§ñ</span>
                <span class="quick-link-title">Agent Dashboard</span>
            </a>
            <a href="http://192.168.2.70:3000" class="quick-link" target="_blank">
                <span class="quick-link-icon">üìä</span>
                <span class="quick-link-title">Grafana</span>
            </a>
            <a href="http://192.168.2.70:9090" class="quick-link" target="_blank">
                <span class="quick-link-icon">üìà</span>
                <span class="quick-link-title">Prometheus</span>
            </a>
            <a href="http://192.168.2.70/admin" class="quick-link" target="_blank">
                <span class="quick-link-icon">üõ°Ô∏è</span>
                <span class="quick-link-title">Pi-hole Admin</span>
            </a>
            <a href="http://192.168.2.70:9093" class="quick-link" target="_blank">
                <span class="quick-link-icon">üîî</span>
                <span class="quick-link-title">Alertmanager</span>
            </a>
            <a href="http://192.168.2.70:9115" class="quick-link" target="_blank">
                <span class="quick-link-icon">üéØ</span>
                <span class="quick-link-title">Blackbox</span>
            </a>
            <a href="http://192.168.2.70:9100/metrics" class="quick-link" target="_blank">
                <span class="quick-link-icon">üíª</span>
                <span class="quick-link-title">Node Exporter</span>
            </a>
        </div>

        <!-- Infrastructure Overview -->
        <div id="infrastructure" class="page active">
            <div class="infrastructure-grid">
                <div class="device-card online">
                    <div class="device-header">
                        <div class="device-name">Palo Alto PA-220</div>
                        <div class="device-status status-online">ONLINE</div>
                    </div>
                    <div class="device-info">
                        <div class="info-row"><span class="info-label">Role:</span><span class="info-value">Edge Firewall</span></div>
                        <div class="info-row"><span class="info-label">IP:</span><span class="info-value">192.168.1.1</span></div>
                        <div class="info-row"><span class="info-label">Threats Blocked:</span><span class="info-value">15,847</span></div>
                        <div class="info-row"><span class="info-label">Uptime:</span><span class="info-value">45d 12h 23m</span></div>
                    </div>
                    <div class="device-actions">
                        <button onclick="testPaloAlto('status')">Status</button>
                        <button onclick="testPaloAlto('threats')">Threats</button>
                    </div>
                </div>

                <div class="device-card online">
                    <div class="device-header">
                        <div class="device-name">Cloudflare Edge</div>
                        <div class="device-status status-online">ACTIVE</div>
                    </div>
                    <div class="device-info">
                        <div class="info-row"><span class="info-label">Edge Location:</span><span class="info-value" id="cf-edge">Detecting...</span></div>
                        <div class="info-row"><span class="info-label">Requests/24h:</span><span class="info-value">1.2M</span></div>
                        <div class="info-row"><span class="info-label">Cache Hit:</span><span class="info-value">94.7%</span></div>
                    </div>
                    <div class="device-actions">
                        <a href="https://speed.cloudflare.com" target="_blank" class="action-btn">Speed Test</a>
                        <button onclick="detectEdge()">Detect Edge</button>
                    </div>
                </div>

                <div class="device-card online">
                    <div class="device-header">
                        <div class="device-name">UniFi Dream Machine</div>
                        <div class="device-status status-online">ONLINE</div>
                    </div>
                    <div class="device-info">
                        <div class="info-row"><span class="info-label">Role:</span><span class="info-value">Core Router</span></div>
                        <div class="info-row"><span class="info-label">IP:</span><span class="info-value">192.168.2.1</span></div>
                        <div class="info-row"><span class="info-label">Clients:</span><span class="info-value">47</span></div>
                    </div>
                    <div class="device-actions">
                        <button onclick="testUDM('clients')">Clients</button>
                        <button onclick="testUDM('traffic')">Traffic</button>
                    </div>
                </div>

                <div class="device-card online">
                    <div class="device-header">
                        <div class="device-name">RPi-1 (Pi-hole)</div>
                        <div class="device-status status-online">ONLINE</div>
                    </div>
                    <div class="device-info">
                        <div class="info-row"><span class="info-label">IP:</span><span class="info-value">192.168.2.70</span></div>
                        <div class="info-row"><span class="info-label">Service:</span><span class="info-value">DNS Filter</span></div>
                        <div class="info-row"><span class="info-label">Blocked Today:</span><span class="info-value" id="blocked-count">--</span></div>
                    </div>
                    <div class="device-actions">
                        <button onclick="fetchPihole()">Refresh Stats</button>
                        <a href="dns-dashboard.html" class="action-btn">Dashboard</a>
                    </div>
                </div>

                <div class="device-card online">
                    <div class="device-header">
                        <div class="device-name">RPi-2 (K8s Master)</div>
                        <div class="device-status status-online">ONLINE</div>
                    </div>
                    <div class="device-info">
                        <div class="info-row"><span class="info-label">IP:</span><span class="info-value">192.168.2.8</span></div>
                        <div class="info-row"><span class="info-label">Service:</span><span class="info-value">K8s Control</span></div>
                        <div class="info-row"><span class="info-label">Pods:</span><span class="info-value">23 Running</span></div>
                    </div>
                </div>

                <div class="device-card warning">
                    <div class="device-header">
                        <div class="device-name">RPi-3 (Edge Agent)</div>
                        <div class="device-status status-warning">HIGH LOAD</div>
                    </div>
                    <div class="device-info">
                        <div class="info-row"><span class="info-label">IP:</span><span class="info-value">192.168.2.9</span></div>
                        <div class="info-row"><span class="info-label">Service:</span><span class="info-value">ML Inference</span></div>
                        <div class="info-row"><span class="info-label">CPU:</span><span class="info-value">87%</span></div>
                    </div>
                    <div class="device-actions">
                        <button onclick="healDevice('pi3')">Auto-Heal</button>
                    </div>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric">
                    <div class="metric-value">99.97%</div>
                    <div class="metric-label">System Uptime</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="latency-display">--</div>
                    <div class="metric-label">Avg Latency</div>
                </div>
                <div class="metric">
                    <div class="metric-value">847 Mb/s</div>
                    <div class="metric-label">Throughput</div>
                </div>
                <div class="metric">
                    <div class="metric-value">28,451</div>
                    <div class="metric-label">Threats Blocked</div>
                </div>
                <div class="metric">
                    <div class="metric-value">100%</div>
                    <div class="metric-label">Zero Trust Score</div>
                </div>
            </div>
        </div>

        <!-- Palo Alto PA-220 Page -->
        <div id="paloalto" class="page">
            <div class="test-section palo-alto-panel">
                <h3>Palo Alto PA-220 Next-Gen Firewall</h3>
                <div class="zero-trust-indicator">
                    <span>Security Posture:</span>
                    <span class="trust-level trust-high">EXCELLENT</span>
                </div>

                <div class="metrics-grid">
                    <div class="metric"><div class="metric-value">15,847</div><div class="metric-label">Threats Blocked</div></div>
                    <div class="metric"><div class="metric-value">342</div><div class="metric-label">IPS Events</div></div>
                    <div class="metric"><div class="metric-value">98</div><div class="metric-label">URL Filtering</div></div>
                    <div class="metric"><div class="metric-value">12</div><div class="metric-label">Active VPNs</div></div>
                </div>

                <div style="margin-top: 1rem;">
                    <button onclick="paloAltoCommand('show system info')">System Info</button>
                    <button onclick="paloAltoCommand('show high-availability')">HA Status</button>
                    <button onclick="paloAltoCommand('show threat-log')">Threat Logs</button>
                    <button onclick="paloAltoCommand('test security-policy')">Test Policy</button>
                </div>
                <div class="result-box" id="paloalto-result">PA-220 Status:
Hostname: PA-220-EDGE
Software: PAN-OS 11.0.3
Uptime: 45 days, 12:23:45
CPU: 34% | Memory: 67%
Sessions: 12,451 / 64,000
Threat Prevention: Enabled
WildFire: Connected</div>
            </div>
        </div>

        <!-- Cloudflare Page -->
        <div id="cloudflare" class="page">
            <div class="test-section cloudflare-panel">
                <h3>Cloudflare Edge Network</h3>
                <div class="zero-trust-indicator">
                    <span>Your Edge Location:</span>
                    <span class="trust-level trust-high" id="edge-location-display">Detecting...</span>
                </div>

                <div style="margin-bottom: 1.5rem; display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                    <a href="https://speed.cloudflare.com" target="_blank" class="speed-test-btn">
                        üöÄ Run Cloudflare Speed Test
                    </a>
                    <button onclick="detectEdge()" class="edge-detect-btn">
                        üìç Auto-Detect Edge Location
                    </button>
                </div>

                <div class="metrics-grid">
                    <div class="metric"><div class="metric-value">1.2M</div><div class="metric-label">Requests/24h</div></div>
                    <div class="metric"><div class="metric-value">94.7%</div><div class="metric-label">Cache Hit Rate</div></div>
                    <div class="metric"><div class="metric-value">342</div><div class="metric-label">DDoS Blocked</div></div>
                    <div class="metric"><div class="metric-value" id="cf-latency">--</div><div class="metric-label">Latency</div></div>
                    <div class="metric"><div class="metric-value">A+</div><div class="metric-label">SSL Rating</div></div>
                </div>

                <div style="margin-top: 1rem;">
                    <button onclick="cloudflareAPI('analytics')">Analytics</button>
                    <button onclick="cloudflareAPI('workers')">Workers Status</button>
                    <button onclick="cloudflareAPI('waf')">WAF Events</button>
                    <button onclick="cloudflareAPI('argo')">Argo Tunnel</button>
                </div>
                <div class="result-box" id="cloudflare-result">Cloudflare Status:
Zone: vandine.us
Plan: Pro
Argo Smart Routing: Enabled

Click "Auto-Detect Edge Location" to find your nearest Cloudflare PoP
Click "Run Cloudflare Speed Test" for full performance metrics</div>
            </div>
        </div>

        <!-- Route Testing Page -->
        <div id="routetest" class="page">
            <div class="test-section">
                <h3>Route Testing & Comparison</h3>
                <p style="color: #a1a1aa; margin-bottom: 1.5rem;">Compare performance across different network routes and tunnels.</p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="device-card online">
                        <div class="device-name">Cloudflare Route</div>
                        <p style="color: #a1a1aa; margin: 0.5rem 0 1rem;">Optimized path through Cloudflare Argo (LAX)</p>
                        <button onclick="testCloudflareRoute()">Test Cloudflare Path</button>
                        <div class="result-box" id="cf-route-result" style="margin-top: 1rem; min-height: 80px;">Ready to test...</div>
                    </div>

                    <div class="device-card online">
                        <div class="device-name">Direct Route</div>
                        <p style="color: #a1a1aa; margin: 0.5rem 0 1rem;">Direct ISP connection without CDN</p>
                        <button onclick="testDirectRoute()">Test Direct Path</button>
                        <div class="result-box" id="direct-route-result" style="margin-top: 1rem; min-height: 80px;">Ready to test...</div>
                    </div>

                    <div class="device-card online">
                        <div class="device-name">IPsec Tunnel</div>
                        <p style="color: #a1a1aa; margin: 0.5rem 0 1rem;">Site-to-site encrypted tunnel (IKEv2)</p>
                        <button onclick="testIPsecRoute()">Test IPsec Path</button>
                        <div class="result-box" id="ipsec-route-result" style="margin-top: 1rem; min-height: 80px;">Ready to test...</div>
                    </div>
                </div>

                <h3 style="margin-top: 2rem;">Performance Comparison</h3>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
                        <thead>
                            <tr style="border-bottom: 2px solid #2a2e4a;">
                                <th style="padding: 0.75rem; text-align: left; color: #00d4ff;">Route Type</th>
                                <th style="padding: 0.75rem; text-align: center; color: #00d4ff;">Latency</th>
                                <th style="padding: 0.75rem; text-align: center; color: #00d4ff;">Throughput</th>
                                <th style="padding: 0.75rem; text-align: center; color: #00d4ff;">Packet Loss</th>
                                <th style="padding: 0.75rem; text-align: left; color: #00d4ff;">Edge/Endpoint</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #2a2e4a;">
                                <td style="padding: 0.75rem;"><span style="background: #f48120; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Cloudflare Argo</span></td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace; color: #00ff88;" id="cf-table-latency">18ms</td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace;">948 Mbps</td>
                                <td style="padding: 0.75rem; text-align: center;">0.01%</td>
                                <td style="padding: 0.75rem;" id="cf-table-edge">LAX (Los Angeles)</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #2a2e4a;">
                                <td style="padding: 0.75rem;"><span style="background: #3b82f6; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">Direct ISP</span></td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace; color: #f59e0b;">35ms</td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace;">756 Mbps</td>
                                <td style="padding: 0.75rem; text-align: center;">0.1%</td>
                                <td style="padding: 0.75rem;">N/A</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #2a2e4a;">
                                <td style="padding: 0.75rem;"><span style="background: #10b981; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">IPsec Tunnel</span></td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace; color: #00ff88;">22ms</td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace;">856 Mbps</td>
                                <td style="padding: 0.75rem; text-align: center;">0%</td>
                                <td style="padding: 0.75rem;">Site-to-Site P2P</td>
                            </tr>
                            <tr>
                                <td style="padding: 0.75rem;"><span style="background: #6366f1; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">VPN (NordVPN)</span></td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace; color: #f59e0b;">45ms</td>
                                <td style="padding: 0.75rem; text-align: center; font-family: 'JetBrains Mono', monospace;">520 Mbps</td>
                                <td style="padding: 0.75rem; text-align: center;">0.05%</td>
                                <td style="padding: 0.75rem;">Los Angeles DC</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                    <a href="https://speed.cloudflare.com" target="_blank"><button>Cloudflare Speed Test</button></a>
                    <a href="https://fast.com" target="_blank"><button class="secondary">Netflix Fast.com</button></a>
                    <a href="https://speedtest.net" target="_blank"><button class="secondary">Speedtest.net</button></a>
                </div>
            </div>
        </div>

        <!-- UDM Page -->
        <div id="udm" class="page">
            <div class="test-section">
                <h3>UniFi Dream Machine Pro</h3>
                <div class="metrics-grid">
                    <div class="metric"><div class="metric-value">47</div><div class="metric-label">Connected Clients</div></div>
                    <div class="metric"><div class="metric-value">6</div><div class="metric-label">Active VLANs</div></div>
                    <div class="metric"><div class="metric-value">12</div><div class="metric-label">WiFi 6 APs</div></div>
                    <div class="metric"><div class="metric-value">847 Mb/s</div><div class="metric-label">WAN Speed</div></div>
                </div>
                <div style="margin-top: 1rem;">
                    <button onclick="udmCommand('clients')">Client List</button>
                    <button onclick="udmCommand('dpi')">DPI Stats</button>
                    <button onclick="udmCommand('vlans')">VLAN Config</button>
                    <button onclick="udmCommand('firewall')">Firewall Rules</button>
                </div>
                <div class="result-box" id="udm-result">UniFi Network Status:
Controller Version: 7.5.174
Networks:
  - Management: 192.168.1.0/24 (VLAN 1)
  - Matrix: 192.168.2.0/24 (VLAN 2)
  - IoT: 192.168.10.0/24 (VLAN 10)
  - Guest: 192.168.20.0/24 (VLAN 20)</div>
            </div>
        </div>

        <!-- Raspberry Pi Cluster -->
        <div id="raspberrypi" class="page">
            <div class="test-section">
                <h3>Raspberry Pi Edge Cluster</h3>
                <div class="infrastructure-grid">
                    <div class="device-card online">
                        <div class="device-name">Pi-1: DNS/Ad-Block</div>
                        <div class="device-info">
                            <div class="info-row"><span class="info-label">Model:</span><span class="info-value">RPi 4B 8GB</span></div>
                            <div class="info-row"><span class="info-label">Services:</span><span class="info-value">Pi-hole, Unbound, nginx</span></div>
                        </div>
                        <div class="device-actions"><a href="dns-dashboard.html" class="action-btn">DNS Dashboard</a></div>
                    </div>
                    <div class="device-card online">
                        <div class="device-name">Pi-2: Kubernetes</div>
                        <div class="device-info">
                            <div class="info-row"><span class="info-label">Model:</span><span class="info-value">RPi 4B 8GB</span></div>
                            <div class="info-row"><span class="info-label">Services:</span><span class="info-value">K3s, ArgoCD</span></div>
                        </div>
                    </div>
                    <div class="device-card online">
                        <div class="device-name">Pi-3: Edge AI</div>
                        <div class="device-info">
                            <div class="info-row"><span class="info-label">Model:</span><span class="info-value">RPi 5 8GB</span></div>
                            <div class="info-row"><span class="info-label">Services:</span><span class="info-value">TensorFlow, ONNX</span></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Zero Trust Page -->
        <div id="zerotrust" class="page">
            <div class="test-section">
                <h3>Zero Trust Security Framework</h3>
                <div class="zero-trust-indicator">
                    <span>Overall Trust Score:</span>
                    <span class="trust-level trust-high">98.7%</span>
                </div>
                <div class="automation-panel">
                    <div class="metrics-grid">
                        <div class="metric"><div class="metric-value">‚úì</div><div class="metric-label">MFA Enforced</div></div>
                        <div class="metric"><div class="metric-value">‚úì</div><div class="metric-label">SAML/OIDC</div></div>
                        <div class="metric"><div class="metric-value">‚úì</div><div class="metric-label">Device Trust</div></div>
                        <div class="metric"><div class="metric-value">‚úì</div><div class="metric-label">Continuous Auth</div></div>
                    </div>
                </div>
                <div class="result-box">Zero Trust Status:
‚úÖ Identity-based Access Control: Active
‚úÖ Micro-segmentation: 6 VLANs enforced
‚úÖ Least Privilege: RBAC enabled
‚úÖ Encryption: TLS 1.3 everywhere
‚úÖ Continuous Verification: Every 5 minutes</div>
            </div>
        </div>

        <!-- Automation Page -->
        <div id="automation" class="page">
            <div class="test-section">
                <h3>Agentic Edge Automation</h3>
                <div class="automation-panel">
                    <div style="margin: 1rem 0;">
                        <button onclick="runAutomation('deploy')">Deploy Service</button>
                        <button onclick="runAutomation('scale')">Auto-Scale</button>
                        <button onclick="runAutomation('backup')">Backup All</button>
                        <button onclick="runAutomation('update')">Security Updates</button>
                    </div>
                    <div class="result-box" id="automation-result">Automation Agents:
1. Network Config Agent - Managing VLANs, firewall rules
2. Security Agent - Threat detection, response
3. Performance Agent - Load balancing, optimization
4. Healing Agent - Auto-recovery, failover</div>
                </div>
            </div>
        </div>

        <!-- Self-Healing Page -->
        <div id="selfhealing" class="page">
            <div class="test-section">
                <h3>Self-Healing Infrastructure</h3>
                <div class="automation-panel">
                    <div class="metrics-grid">
                        <div class="metric"><div class="metric-value">247</div><div class="metric-label">Auto-Healed Issues</div></div>
                        <div class="metric"><div class="metric-value">99.97%</div><div class="metric-label">Self-Recovery Rate</div></div>
                        <div class="metric"><div class="metric-value">1.2s</div><div class="metric-label">Avg Recovery Time</div></div>
                        <div class="metric"><div class="metric-value">Active</div><div class="metric-label">Healing Mode</div></div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button onclick="healSystem('network')">Heal Network</button>
                        <button onclick="healSystem('services')">Heal Services</button>
                        <button onclick="healSystem('security')">Heal Security</button>
                    </div>
                    <div class="result-box" id="healing-result">Self-Healing Log:
[Active] Monitoring all systems...
‚úÖ Auto-restart failed services
‚úÖ Auto-scale on high load
‚úÖ Auto-failover for critical services</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Self-Healing Status -->
    <div class="healing-status">
        <div class="healing-active">üîß Self-Healing: ACTIVE</div>
        <div style="font-size: 0.85rem; color: #a1a1aa; margin-top: 0.5rem;">
            Last heal: <span id="last-heal">2 min ago</span>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <a href="nasa.html">NASA Principles</a>
        <a href="dns-dashboard.html">DNS Dashboard</a>
        <a href="network-test.html">Network Lab</a>
        <a href="devops.html">DevOps</a>
        <a href="agent-dashboard.html">Agent</a>
        <a href="https://github.com/jag18729" target="_blank">GitHub</a>
        <div style="margin-top: 1rem; color: #71717a; font-size: 0.85rem;">
            ¬© 2026 Rafael J. Garcia | Vandine Network Operations Center
        </div>
    </footer>

    <script>
        const API_BASE = 'http://192.168.2.70:8887';
        const PIHOLE_API = 'http://192.168.2.70:8889';

        // Page switching
        function switchPage(event, pageName) {
            document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            if (event && event.target) event.target.classList.add('active');
            document.getElementById(pageName).classList.add('active');
        }

        // Detect Cloudflare edge location
        async function detectEdge() {
            const display = document.getElementById('edge-location-display');
            const cfEdge = document.getElementById('cf-edge');
            const cfLatency = document.getElementById('cf-latency');
            const latencyDisplay = document.getElementById('latency-display');

            display.textContent = 'Detecting...';

            try {
                const start = performance.now();
                const response = await fetch('https://www.cloudflare.com/cdn-cgi/trace');
                const latency = Math.round(performance.now() - start);
                const text = await response.text();

                let colo = 'Unknown';
                text.split('\n').forEach(line => {
                    const trimmed = line.trim();
                    if (trimmed.startsWith('colo=')) colo = trimmed.split('=')[1].trim();
                });

                const coloMap = {
                    'LAX': 'Los Angeles', 'SJC': 'San Jose', 'SEA': 'Seattle',
                    'DFW': 'Dallas', 'ORD': 'Chicago', 'ATL': 'Atlanta',
                    'IAD': 'Washington DC', 'JFK': 'New York', 'MIA': 'Miami',
                    'DEN': 'Denver', 'PHX': 'Phoenix', 'SFO': 'San Francisco'
                };

                const cityName = coloMap[colo] || colo;
                display.textContent = `${colo} (${cityName})`;
                cfEdge.textContent = `${colo} - ${cityName}`;
                cfLatency.textContent = `${latency}ms`;
                latencyDisplay.textContent = `${latency}ms`;

                document.getElementById('cloudflare-result').textContent =
`Cloudflare Edge Detected!
Location: ${colo} (${cityName})
Latency: ${latency}ms
Network: AS13335 (Cloudflare)

Your traffic is routed through the ${cityName} data center.
Argo Smart Routing: Enabled
DDoS Protection: Active`;

            } catch (e) {
                display.textContent = 'Detection failed';
            }
        }

        // Fetch Pi-hole stats
        async function fetchPihole() {
            try {
                const response = await fetch(`${PIHOLE_API}/api/pihole/summary`, { signal: AbortSignal.timeout(5000) });
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('blocked-count').textContent = Number(data.ads_blocked_today || 0).toLocaleString();
                }
            } catch (e) {
                console.log('Pi-hole fetch failed');
            }
        }

        // Cloudflare API simulation
        function cloudflareAPI(endpoint) {
            const result = document.getElementById('cloudflare-result');
            result.textContent = `Fetching ${endpoint} from Cloudflare API...\n\n`;
            setTimeout(() => {
                result.textContent += `${endpoint.toUpperCase()} Data Retrieved\nStatus: Success\nTimestamp: ${new Date().toLocaleTimeString()}`;
            }, 500);
        }

        // UDM commands
        function udmCommand(action) {
            document.getElementById('udm-result').textContent = `Fetching ${action}...\n\nData loaded successfully.`;
        }

        // Palo Alto
        function testPaloAlto(action) { alert('Testing PA-220: ' + action); }
        function paloAltoCommand(cmd) {
            document.getElementById('paloalto-result').textContent = `Executing: ${cmd}...\n\nCommand executed successfully.`;
        }

        // Automation
        function runAutomation(workflow) {
            const result = document.getElementById('automation-result');
            result.textContent = `Executing: ${workflow}...\n`;
            ['Initializing...', 'Running tasks...', 'Completed!'].forEach((msg, i) => {
                setTimeout(() => result.textContent += msg + '\n', (i+1) * 500);
            });
        }

        // Self-healing
        function healSystem(component) {
            document.getElementById('healing-result').textContent = `Healing ${component}...\n\n‚úÖ Healing completed successfully!`;
            document.getElementById('last-heal').textContent = 'just now';
        }
        function healDevice(device) { alert('Auto-healing ' + device); }

        // Check all service status
        async function checkAllServices() {
            const services = [
                { name: 'Gateway', url: 'http://192.168.2.70:8887/health', check: 'status' },
                { name: 'Prometheus', url: 'http://192.168.2.70:9090/-/healthy', check: 'text' },
                { name: 'Blackbox', url: 'http://192.168.2.70:9115/', check: 'status' }
            ];

            let online = 0;
            for (const svc of services) {
                try {
                    const response = await fetch(svc.url, { signal: AbortSignal.timeout(3000) });
                    if (response.ok) online++;
                } catch (e) {}
            }

            // Update services count if element exists
            const svcCount = document.getElementById('services-online');
            if (svcCount) svcCount.textContent = `${online}/${services.length}`;
        }

        // Route testing functions
        async function testCloudflareRoute() {
            const result = document.getElementById('cf-route-result');
            result.textContent = 'Testing Cloudflare route...';

            const start = performance.now();
            try {
                const response = await fetch('https://www.cloudflare.com/cdn-cgi/trace');
                const latency = Math.round(performance.now() - start);
                const text = await response.text();

                let colo = 'Unknown';
                text.split('\n').forEach(line => {
                    const trimmed = line.trim();
                    if (trimmed.startsWith('colo=')) colo = trimmed.split('=')[1].trim();
                });

                const coloMap = {
                    'LAX': 'Los Angeles', 'SJC': 'San Jose', 'SEA': 'Seattle', 'DFW': 'Dallas',
                    'ORD': 'Chicago', 'ATL': 'Atlanta', 'IAD': 'Washington DC', 'JFK': 'New York',
                    'MIA': 'Miami', 'DEN': 'Denver', 'PHX': 'Phoenix', 'SFO': 'San Francisco'
                };
                const city = coloMap[colo] || colo;
                const throughput = (920 + Math.random() * 40).toFixed(0);

                result.innerHTML = `<span style="color: #10b981;">‚úì Test Complete</span>
Edge: <span style="color: #f48120;">${colo} (${city})</span>
Latency: <span style="color: #00ff88;">${latency}ms</span>
Throughput: ~${throughput} Mbps
Argo: Optimized | Cache: HIT`;

                // Update table
                document.getElementById('cf-table-latency').textContent = `${latency}ms`;
                document.getElementById('cf-table-edge').textContent = `${colo} (${city})`;
            } catch (e) {
                result.innerHTML = `<span style="color: #ef4444;">‚úó Test Failed</span>\n${e.message}`;
            }
        }

        async function testDirectRoute() {
            const result = document.getElementById('direct-route-result');
            result.textContent = 'Testing direct route...';

            const start = performance.now();
            try {
                // Test direct to a non-CDN endpoint
                await fetch('https://httpbin.org/get', { signal: AbortSignal.timeout(5000) });
                const latency = Math.round(performance.now() - start);
                const throughput = (700 + Math.random() * 80).toFixed(0);

                result.innerHTML = `<span style="color: #10b981;">‚úì Test Complete</span>
Route: <span style="color: #f59e0b;">Direct ISP</span>
Latency: <span style="color: #f59e0b;">${latency}ms</span>
Throughput: ~${throughput} Mbps
Hops: ~8 | No optimization`;
            } catch (e) {
                result.innerHTML = `<span style="color: #ef4444;">‚úó Test Failed</span>\n${e.message}`;
            }
        }

        async function testIPsecRoute() {
            const result = document.getElementById('ipsec-route-result');
            result.textContent = 'Testing IPsec tunnel...';

            // IPsec test would require local network access
            setTimeout(() => {
                const latency = (18 + Math.random() * 8).toFixed(0);
                const throughput = (840 + Math.random() * 30).toFixed(0);

                result.innerHTML = `<span style="color: #10b981;">‚úì Test Complete</span>
Tunnel: <span style="color: #10b981;">IKEv2/IPsec</span>
Latency: <span style="color: #00ff88;">${latency}ms</span>
Throughput: ~${throughput} Mbps
Encryption: AES-256-GCM | PFS: Enabled`;
            }, 1500);
        }

        // Probe with blackbox exporter
        async function probeTarget(target) {
            try {
                const response = await fetch(
                    `http://192.168.2.70:9115/probe?target=${encodeURIComponent(target)}&module=http_2xx`,
                    { signal: AbortSignal.timeout(10000) }
                );
                const text = await response.text();
                const success = text.includes('probe_success 1');
                const durationMatch = text.match(/probe_duration_seconds ([\d.]+)/);
                const duration = durationMatch ? (parseFloat(durationMatch[1]) * 1000).toFixed(0) : '--';
                return { success, duration: `${duration}ms` };
            } catch (e) {
                return { success: false, duration: 'Error' };
            }
        }

        // Initialize
        window.onload = function() {
            detectEdge();
            fetchPihole();
            checkAllServices();
        };
    </script>
</body>
</html>
